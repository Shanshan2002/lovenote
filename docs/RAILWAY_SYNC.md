# ğŸš€ Railwayå®šæ—¶åŒæ­¥æŒ‡å—

## ğŸ¯ è‡ªåŠ¨åŒæ­¥ç³»ç»Ÿ

### åŠŸèƒ½è¯´æ˜

è‡ªåŠ¨å°†æœ¬åœ°ç”¨æˆ·æ•°æ®åŒæ­¥åˆ°Railwayï¼Œç¡®ä¿ä¸¤è¾¹æ•°æ®ä¸€è‡´ã€‚

---

## âš¡ å¿«é€Ÿé…ç½®

### ä¸€é”®é…ç½®ï¼ˆæ¨èï¼‰

```bash
./scripts/setup-railway-sync.sh
```

é€‰æ‹©é€‰é¡¹ **2**ï¼ˆæ¯6å°æ—¶åŒæ­¥ï¼‰â­

---

## ğŸ“‹ åŒæ­¥é¢‘ç‡é€‰é¡¹

### 1. æ¯å°æ—¶åŒæ­¥
```
é¢‘ç‡: æ¯å°æ—¶
åœºæ™¯: é¢‘ç¹æ›´æ–°ç”¨æˆ·
ç¼ºç‚¹: å¯èƒ½è¿‡äºé¢‘ç¹
```

### 2. æ¯6å°æ—¶åŒæ­¥ â­ æ¨è
```
é¢‘ç‡: æ¯å¤©4æ¬¡ï¼ˆ0ç‚¹ã€6ç‚¹ã€12ç‚¹ã€18ç‚¹ï¼‰
åœºæ™¯: æ—¥å¸¸ä½¿ç”¨
ä¼˜ç‚¹: å¹³è¡¡åŠæ—¶æ€§å’Œèµ„æºæ¶ˆè€—
```

### 3. æ¯å¤©åŒæ­¥
```
é¢‘ç‡: æ¯å¤©å‡Œæ™¨3ç‚¹
åœºæ™¯: ç¨³å®šä½¿ç”¨
ä¼˜ç‚¹: èµ„æºæ¶ˆè€—æœ€å°
```

### 4. æ¯å‘¨åŒæ­¥
```
é¢‘ç‡: æ¯å‘¨æ—¥å‡Œæ™¨4ç‚¹
åœºæ™¯: å¾ˆå°‘æ›´æ–°
ä¼˜ç‚¹: æœ€å°åŒ–åŒæ­¥
```

---

## ğŸ”§ æ‰‹åŠ¨é…ç½®

### ä½¿ç”¨crontab

```bash
# 1. ç¼–è¾‘crontab
crontab -e

# 2. æ·»åŠ å®šæ—¶ä»»åŠ¡ï¼ˆæ¯6å°æ—¶ï¼‰
0 */6 * * * /Users/shanshanwang/CascadeProjects/windsurf-project/scripts/auto-sync-railway.sh

# 3. ä¿å­˜é€€å‡º
```

### ä½¿ç”¨launchdï¼ˆMacæ¨èï¼‰

```bash
# åˆ›å»ºplistæ–‡ä»¶
cat > ~/Library/LaunchAgents/com.lovenote.railwaysync.plist << 'EOF'
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN">
<plist version="1.0">
<dict>
    <key>Label</key>
    <string>com.lovenote.railwaysync</string>
    <key>ProgramArguments</key>
    <array>
        <string>/Users/shanshanwang/CascadeProjects/windsurf-project/scripts/auto-sync-railway.sh</string>
    </array>
    <key>StartInterval</key>
    <integer>21600</integer>  <!-- 6å°æ—¶ = 21600ç§’ -->
</dict>
</plist>
EOF

# åŠ è½½ä»»åŠ¡
launchctl load ~/Library/LaunchAgents/com.lovenote.railwaysync.plist
```

---

## ğŸ§ª æµ‹è¯•åŒæ­¥

### æµ‹è¯•è„šæœ¬

```bash
./scripts/test-railway-sync.sh
```

**æµ‹è¯•å†…å®¹ï¼š**
1. âœ… Railwayè¿æ¥çŠ¶æ€
2. âœ… æœ¬åœ°æ•°æ®æ£€æŸ¥
3. âœ… Railway APIæµ‹è¯•
4. âœ… æ‰§è¡ŒåŒæ­¥æµ‹è¯•

### æ‰‹åŠ¨åŒæ­¥

```bash
./scripts/auto-sync-railway.sh
```

---

## ğŸ“Š åŒæ­¥æœºåˆ¶

### åŒæ­¥é€»è¾‘

```
è¯»å–æœ¬åœ°ç”¨æˆ·
    â†“
é€ä¸ªå°è¯•åœ¨Railwayæ³¨å†Œ
    â†“
å·²å­˜åœ¨ â†’ è·³è¿‡
ä¸å­˜åœ¨ â†’ åˆ›å»º
é”™è¯¯   â†’ è®°å½•æ—¥å¿—
    â†“
å®ŒæˆåŒæ­¥
```

### åŒæ­¥å†…å®¹

**å½“å‰ç‰ˆæœ¬ï¼š**
- âœ… ç”¨æˆ·è´¦æˆ·ï¼ˆusername + passwordï¼‰
- âœ… ç®¡ç†å‘˜æƒé™ï¼ˆç¬¬ä¸€ä¸ªç”¨æˆ·è‡ªåŠ¨æˆä¸ºç®¡ç†å‘˜ï¼‰

**ä¸åŒæ­¥ï¼š**
- âŒ æ¶ˆæ¯å†…å®¹ï¼ˆRailwayå’Œæœ¬åœ°ç‹¬ç«‹ï¼‰
- âŒ ç”¨æˆ·IDï¼ˆRailwayé‡æ–°ç”Ÿæˆï¼‰

---

## ğŸ“ æ—¥å¿—ç®¡ç†

### æŸ¥çœ‹æ—¥å¿—

```bash
# å®æ—¶æŸ¥çœ‹
tail -f logs/railway-sync.log

# æŸ¥çœ‹æœ€è¿‘è®°å½•
tail -20 logs/railway-sync.log

# æŸ¥çœ‹æ‰€æœ‰è®°å½•
cat logs/railway-sync.log
```

### æ—¥å¿—æ ¼å¼

```
======================================
å¼€å§‹åŒæ­¥ - 2025-11-21 23:45:00
âœ… Railwayåœ¨çº¿
ğŸ‘¥ åŒæ­¥ç”¨æˆ·åˆ°Railway...
âœ… Shanshan
â­ï¸  Wang (å·²å­˜åœ¨)
åŒæ­¥ç»“æœ: æˆåŠŸ 1, è·³è¿‡ 1, é”™è¯¯ 0
âœ… åŒæ­¥å®Œæˆ - 2025-11-21 23:45:05
æœ¬åœ°ç”¨æˆ·æ•°: 2
======================================
```

---

## ğŸ” ç›‘æ§å’ŒéªŒè¯

### æ£€æŸ¥å®šæ—¶ä»»åŠ¡

```bash
# æŸ¥çœ‹crontab
crontab -l | grep railway

# æŸ¥çœ‹launchdä»»åŠ¡
launchctl list | grep lovenote
```

### éªŒè¯åŒæ­¥ç»“æœ

```bash
# 1. æŸ¥çœ‹æœ¬åœ°ç”¨æˆ·
cat data/users.json

# 2. æŸ¥çœ‹Railwayç”¨æˆ·
curl https://lovenote-production.up.railway.app/api/users

# 3. å¯¹æ¯”æ•°é‡
echo "æœ¬åœ°: $(cat data/users.json | grep -o '"id"' | wc -l)"
echo "Railway: $(curl -s https://lovenote-production.up.railway.app/api/users | grep -o '"id"' | wc -l)"
```

---

## âš™ï¸ é«˜çº§é…ç½®

### æ¡ä»¶åŒæ­¥

åªåœ¨æ•°æ®å˜åŒ–æ—¶åŒæ­¥ï¼š

```bash
# ä¿®æ”¹ auto-sync-railway.sh
# æ·»åŠ å“ˆå¸Œæ£€æŸ¥é€»è¾‘
```

### åŒå‘åŒæ­¥

åŒæ—¶ä»RailwayåŒæ­¥åˆ°æœ¬åœ°ï¼š

```bash
# éœ€è¦é¢å¤–å¼€å‘
# ä»Railway APIè¯»å–ç”¨æˆ·
# æ›´æ–°æœ¬åœ°æ•°æ®åº“
```

---

## ğŸ†˜ æ•…éšœæ’é™¤

### åŒæ­¥å¤±è´¥

**æ£€æŸ¥ï¼š**
1. Railwayæ˜¯å¦åœ¨çº¿
2. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
3. APIæ˜¯å¦æ­£å¸¸å“åº”
4. æ—¥å¿—ä¸­çš„é”™è¯¯ä¿¡æ¯

**è§£å†³ï¼š**
```bash
# 1. æµ‹è¯•Railway
curl https://lovenote-production.up.railway.app

# 2. æ‰‹åŠ¨åŒæ­¥æµ‹è¯•
./scripts/test-railway-sync.sh

# 3. æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
cat logs/railway-sync.log
```

### ç”¨æˆ·é‡å¤

**åŸå› ï¼š**
- Railwayå·²æœ‰è¯¥ç”¨æˆ·
- æ­£å¸¸è·³è¿‡

**å¤„ç†ï¼š**
- ç³»ç»Ÿè‡ªåŠ¨è·³è¿‡å·²å­˜åœ¨ç”¨æˆ·
- ä¸ä¼šé‡å¤åˆ›å»º

### æƒé™é”™è¯¯

**ç—‡çŠ¶ï¼š**
```
crontab: tmp/tmp.XXX: Operation not permitted
```

**è§£å†³ï¼š**
```bash
# Mac: ç»™ç»ˆç«¯å®Œå…¨ç£ç›˜è®¿é—®æƒé™
ç³»ç»Ÿåå¥½è®¾ç½® â†’ å®‰å…¨æ€§ä¸éšç§ â†’ å®Œå…¨ç£ç›˜è®¿é—®æƒé™ â†’ æ·»åŠ ç»ˆç«¯

# æˆ–ä½¿ç”¨launchdæ›¿ä»£crontab
```

---

## ğŸ“ˆ æœ€ä½³å®è·µ

### æ¨èé…ç½®

```bash
# 1. é…ç½®æ¯6å°æ—¶åŒæ­¥
./scripts/setup-railway-sync.sh
é€‰æ‹©: 2

# 2. é…ç½®æ¯å¤©å¤‡ä»½
./scripts/setup-auto-backup.sh
é€‰æ‹©: 2

# 3. å®šæœŸæ£€æŸ¥æ—¥å¿—
æ¯å‘¨æŸ¥çœ‹ä¸€æ¬¡: tail logs/railway-sync.log
```

### åŒæ­¥ç­–ç•¥

**å¼€å‘é˜¶æ®µï¼š**
- æ‰‹åŠ¨åŒæ­¥ï¼ˆéœ€è¦æ—¶ï¼‰
- æˆ–æ¯å¤©åŒæ­¥ä¸€æ¬¡

**ç”Ÿäº§é˜¶æ®µï¼š**
- æ¯6å°æ—¶è‡ªåŠ¨åŒæ­¥ â­
- ç¡®ä¿Railwayæ•°æ®åŠæ—¶æ›´æ–°

**ç¨³å®šé˜¶æ®µï¼š**
- æ¯å‘¨åŒæ­¥ä¸€æ¬¡
- æ•°æ®å˜åŒ–ä¸é¢‘ç¹

---

## âœ… é…ç½®éªŒè¯æ¸…å•

- [ ] Railwayåœ¨çº¿
- [ ] åŒæ­¥è„šæœ¬å¯æ‰§è¡Œ
- [ ] å®šæ—¶ä»»åŠ¡å·²é…ç½®
- [ ] æ—¥å¿—ç›®å½•å·²åˆ›å»º
- [ ] æ‰‹åŠ¨æµ‹è¯•æˆåŠŸ
- [ ] æ—¥å¿—æ­£å¸¸è®°å½•

---

## ğŸ¯ æ€»ç»“

### å®Œæ•´åŒæ­¥æµç¨‹

```
æœ¬åœ°ç”¨æˆ·å˜æ›´
    â†“
(å¯é€‰) å®æ—¶å¤‡ä»½
    â†“
å®šæ—¶åŒæ­¥ä»»åŠ¡è§¦å‘
    â†“
è¯»å–æœ¬åœ°æ•°æ®
    â†“
å‘é€åˆ°Railway API
    â†“
Railwayåˆ›å»º/è·³è¿‡ç”¨æˆ·
    â†“
è®°å½•æ—¥å¿—
    â†“
å®ŒæˆåŒæ­¥
```

### æ•°æ®æµå‘

```
æœ¬åœ° (ä¸»æ•°æ®æº)
  â†“
å®šæ—¶åŒæ­¥ (6å°æ—¶)
  â†“
Railway (äº‘ç«¯å‰¯æœ¬)
```

### æ ¸å¿ƒä¼˜åŠ¿

- âœ… è‡ªåŠ¨åŒ– - æ— éœ€æ‰‹åŠ¨æ“ä½œ
- âœ… å®šæ—¶æ‰§è¡Œ - å®šæœŸåŒæ­¥
- âœ… æ—¥å¿—è®°å½• - å¯è¿½æº¯
- âœ… é”™è¯¯å¤„ç† - è‡ªåŠ¨é‡è¯•
- âœ… æ™ºèƒ½è·³è¿‡ - é¿å…é‡å¤

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

```bash
# 1. é…ç½®å®šæ—¶åŒæ­¥
./scripts/setup-railway-sync.sh

# 2. é€‰æ‹©é¢‘ç‡ï¼ˆæ¨èï¼šæ¯6å°æ—¶ï¼‰
é€‰æ‹©: 2

# 3. ç¡®è®¤é…ç½®
è¾“å…¥: y

# 4. å®Œæˆï¼
```

**åŒæ­¥å°†è‡ªåŠ¨è¿è¡Œï¼Œæ— éœ€å†ç®¡ï¼** âœ¨

---

*æœ€åæ›´æ–°: 2025-11-21*  
*ç‰ˆæœ¬: v1.2*  
*çŠ¶æ€: è‡ªåŠ¨åŒæ­¥å°±ç»ª*
